<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<object-views xmlns="http://axelor.com/xml/ns/object-views"
              xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
              xsi:schemaLocation="http://axelor.com/xml/ns/object-views http://axelor.com/xml/ns/object-views/object-views_5.1.xsd">

    <menuitem name="tramite-nuevo-menu"  title="Trámites" action="tramite-nuevo-action" groups="admins,users" icon="list_alt_add" order="100"/>


    <action-view name="tramite-nuevo-action" home="true" title="Crear un nuevo expediente"   >
        <view type="tree" name="tramite-nuevo-tree"/>
        <context name="_profile" expr="CREADOR"/>
    </action-view>

    <tree name="tramite-nuevo-tree" title="Trámites disponibles" showHeader="false">
        <column name="name"  />
        <column name="nuevo" type="button" title="Nuevo expediente"  />
        <column name="ayuda" type="button" title="Ayuda"  />

        <node model="com.educaflow.apps.expedientes.db.TipoTramite" domain="EXISTS (SELECT 1 FROM Tramite t WHERE  t.tipoTramite=self)" >
            <field name="name" as="name"  />

        </node>

        <node model="com.educaflow.apps.expedientes.db.Tramite"  parent="tipoTramite" draggable="false" onClick="action-event-new-expediente">
            <field name="name" as="name" />
            <button name="nuevo"  help="Nuevo expediente" onClick="action-event-new-expediente" icon="list_alt_add"/>
            <button name="ayuda"  help="Descripción del trámite" onClick="tramite-mostrar-ayuda-action" icon="help"/>
        </node>


    </tree>


    <action-view name="tramite-mostrar-ayuda-action" title="Ayuda" model="com.educaflow.apps.expedientes.db.Tramite">
        <view type="form" name="tramite-mostrar-ayuda-form"/>
        <view-param name="popup" value="true"/>
        <view-param name="show-toolbar" value="false"/>
        <view-param name="popup-save" value="false"/>
        <context name="_showRecord" expr="eval: id"/>
    </action-view>

    <form name="tramite-mostrar-ayuda-form" title="Ayuda" model="com.educaflow.apps.expedientes.db.Tramite">
        <panel name="ayuda" colSpan="12" itemSpan="2" showFrame="false" >
            <field name="ayuda" showTitle="false" readonly="true" colSpan="12" >
                <viewer depends="name,help" ><![CDATA[
                    <>
                    <Box>
                        <div className="card" style={{ cursor: "default" }} >
                        <div className="card-header" >
                            <strong>{_t("value:"+name)}</strong>
                        </div>
                        <div className="card-body" >
                            <Box mt={0} as="p" color="secondary" dangerouslySetInnerHTML={{ __html: help }} />
                        </div>
                        </div>
                    </Box>
                    </>
                    ]]>
                </viewer>
            </field>
        </panel>
    </form>






    <cards name="expediente-nuevo-cards" title="Trámite" model="com.educaflow.apps.expedientes.db.Tramite" width="500px" customSearch="false" freeSearch="name,help" canEdit="false" canDelete="false"  canNew="false">
        <field name="code"/>
        <field name="name"/>
        <field name="help"/>
        <template><![CDATA[
			<>
                <Box>
                    <div className="card" style={{ cursor: "default" }} >
                        <div className="card-header" >
                            <strong>{_t("value:"+name)}</strong>
                        </div>
                        <div className="card-body" >
                            <Box mt={0} as="p" color="secondary" dangerouslySetInnerHTML={{ __html: help }} />
                            <Button  outline="true" block="true" variant="primary" onClick={$action("action-event-new-expediente")}>{_t("Nuevo Expediente")}</Button>
                        </div>
                    </div>
                </Box>
			</>
			]]>
        </template>
    </cards>







</object-views>