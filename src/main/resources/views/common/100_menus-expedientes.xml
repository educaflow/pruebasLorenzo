<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<object-views xmlns="http://axelor.com/xml/ns/object-views"
              xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
              xsi:schemaLocation="http://axelor.com/xml/ns/object-views http://axelor.com/xml/ns/object-views/object-views_5.1.xsd">

    <menuitem name="expedientes-menu" title="Expedientes" groups="admins,users" order="100" />
    <menuitem name="expedientes-nuevo-menu" parent="expedientes-menu" title="Nuevo" action="expedientes-nuevo-action" groups="admins,users" icon="list_alt_add"/>
    <menuitem name="expedientes-pendiente-menu" parent="expedientes-menu" title="Creador" action="expedientes-pendiente-action" groups="admins,users"  />
    <menuitem name="expedientes-esperando-menu" parent="expedientes-menu" title="Responsable" action="expedientes-esperando-action" groups="admins,users"/>
    <menuitem name="expedientes-cerrado-menu" parent="expedientes-menu" title="Todos" action="expedientes-cerrado-action" groups="admins,users"/>

    <action-view name="expedientes-nuevo-action" home="true" title="Crear un nuevo expediente" model="com.educaflow.apps.expedientes.db.Tramite"  >
        <view type="cards" name="expediente-nuevo-cards"/>
        <view-param name="show-toolbar" value="false"/>
        <context name="_profile" expr="CREADOR"/>
    </action-view>
    <action-view name="expedientes-pendiente-action" title="Listado de expedientes pendientes de que realices la tarea"  model="com.educaflow.apps.expedientes.db.Expediente">
        <view type="grid" name="expediente-ver-grid-creador"/>
        <domain>self.closed=false AND EXISTS (SELECT 1 FROM com.educaflow.apps.expedientes.db.EstadoTipoExpediente e WHERE e.tipoExpediente.id=self.tipoExpediente.id AND e.codeState=self.codeState AND e.profile='CREADOR')</domain>
        <context name="_profile" expr="CREADOR"/>
    </action-view>
    <action-view name="expedientes-esperando-action" title="Expedientes esperando a que otra persona realice una tarea"  model="com.educaflow.apps.expedientes.db.Expediente" >
        <view type="grid" name="expediente-ver-grid-creador"  />
        <domain>self.closed=false AND EXISTS (SELECT 1 FROM com.educaflow.apps.expedientes.db.EstadoTipoExpediente e WHERE e.tipoExpediente.id=self.tipoExpediente.id AND e.codeState=self.codeState AND e.profile='RESPONSABLE')</domain>
        <context name="_profile" expr="RESPONSABLE"/>
    </action-view>
    <action-view name="expedientes-cerrado-action"  title="Expedientes cerrados" model="com.educaflow.apps.expedientes.db.Expediente">
        <view type="grid" name="expediente-ver-grid-creador"/>
        <context name="_profile" expr="CREADOR"/>
    </action-view>


    <cards name="expediente-nuevo-cards" title="TrÃ¡mite" model="com.educaflow.apps.expedientes.db.Tramite" canEdit="false" canDelete="false"  canNew="false">
        <field name="code"/>
        <field name="name"/>
        <field name="help"/>
        <template><![CDATA[
			<>
                <Box>
                    <strong>{name}</strong>
                    <Box as="p" color="secondary" dangerouslySetInnerHTML={{ __html: help }} />
                    <Button size="sm" outline="true" block="true" variant="primary" onClick={$action("action-event-new-expediente")}>Nuevo Expediente</Button>
                </Box>
			</>
			]]>
        </template>
    </cards>







</object-views>